<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>å¿«éå ±è¡¨ Â· é›™è¡¨æ•´åˆ</title>
    <style>
        /* ----- å…¨åŸŸé‡ç½®ï¼ˆåƒ…ç”¨æ–¼é¸æ“‡å±¤èˆ‡å¤–æ¡†ï¼‰----- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;          /* é˜²æ­¢æ•´é«”æ»¾å‹•ï¼Œç”±å…§éƒ¨å„è‡ªæ§åˆ¶ */
            font-family: "Microsoft JhengHei", sans-serif;
            background-color: #eef2f6;
        }

        /* ----- é¸æ“‡å±¤ (å…¨å±ç½®ä¸­) ----- */
        .selection-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(145deg, #f0f4fa 0%, #d9e0eb 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }
        .selection-card {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(8px);
            border-radius: 40px;
            padding: 30px 25px;
            width: 85%;
            max-width: 400px;
            box-shadow: 0 25px 50px -8px rgba(0,20,40,0.3);
            border: 1px solid rgba(255,255,255,0.4);
            text-align: center;
        }
        .selection-card h2 {
            color: #1e3a5f;
            margin-bottom: 20px;
            font-size: 28px;
        }
        .month-picker {
            margin: 20px 0 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: center;
        }
        .month-picker label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 18px;
        }
        .month-picker input[type="month"] {
            width: 90%;
            padding: 12px 15px;
            border: none;
            border-radius: 50px;
            background: white;
            font-size: 18px;
            text-align: center;
            border: 1px solid #bdc9d5;
        }
        .report-type {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 25px 0 20px;
        }
        .type-btn {
            background: white;
            border: 2px solid #2b4f7b;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 20px;
            font-weight: 700;
            color: #1e3a5f;
            cursor: pointer;
            transition: 0.15s;
            min-width: 110px;
        }
        .type-btn.active {
            background: #1e3a5f;
            color: white;
            border-color: #0f2a44;
        }

        /* ----- å ±è¡¨å®¹å™¨ï¼ˆå›ºå®šå…¨å±ï¼Œåƒ…é¡¯ç¤ºç•¶å‰å ±è¡¨ï¼‰----- */
        .report-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%; /* ã€ä¿®æ­£ã€‘ä½¿ç”¨ 100% é¿å… vw ç”¢ç”Ÿçš„æ©«å‘æ²å‹•è»¸ */
            height: 100%; /* ã€é—œéµä¿®æ­£ã€‘ä½¿ç”¨ 100% å–ä»£ 100vhï¼Œé¿é–‹æ‰‹æ©Ÿå·¥å…·åˆ—åƒé«˜åº¦ */
            background: white;
            z-index: 200;
            display: none;      /* é è¨­éš±è— */
        }
        .report-container.show {
            display: block;
        }

        /* ----- å›ºå®šé€€å‡ºæŒ‰éˆ•ï¼ˆä¸å½±éŸ¿å…§éƒ¨ä½ˆå±€ï¼‰----- */
        .fixed-exit {
            position: fixed;
            top: 12px;
            left: 12px;
            z-index: 1000;
            background: rgba(211, 47, 47, 0.85);
            backdrop-filter: blur(4px);
            border: none;
            color: white;
            font-size: 18px;
            font-weight: bold;
            padding: 8px 22px;
            border-radius: 40px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            border: 1px solid #ff8a80;
            pointer-events: auto;
        }

        /* ========== å ±è¡¨1ï¼ˆæœˆä»¶ï¼‰åŸå§‹æ¨£å¼ ========= */
        #report1 {
            height: 100%;
            width: 100%;
            background-color: #fff;
            display: block;
        }
        #report1 .table-wrapper {
            height: 100%;
            width: 100%;
            overflow-x: auto;
            overflow-y: hidden;
            -webkit-overflow-scrolling: touch;
        }
        #report1 .page {
            height: 100%;
            aspect-ratio: 297 / 210;
            min-width: max(100vw, 800px);
            padding: 0;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            margin: 0 auto;
        }
        @media (orientation: landscape) {
            #report1 .table-wrapper {
                overflow-y: auto;
            }
            #report1 .page {
                height: auto;
                min-height: 100%;
                width: max(100vw, 800px);
                aspect-ratio: 297 / 210;
            }
            #report1 table {
                height: auto !important;
            }
            #report1 th, #report1 td {
                height: 32px !important;
            }
        }
        #report1 .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            padding-bottom: 5px;
            padding-top: 5px;
            padding-left: 5px;
            padding-right: 5px;
        }
        #report1 .underline {
            border-bottom: 1px solid black;
            min-width: 100px;
            display: inline-block;
            text-align: center;
            padding: 0 10px;
        }
        #report1 table {
            width: 100%;
            border-collapse: collapse;
            border: 2px solid black;
            flex: 1 1 0%;
            min-height: 0;
            height: 1px;
            table-layout: fixed;
        }
        #report1 th, #report1 td {
            border: 1px solid black;
            text-align: center;
            font-size: 13px;
            padding: 0;
            color: #000;
            height: 1%;
            white-space: nowrap;
            overflow: hidden;
        }
        #report1 .col-date {
            width: 45px;
            background-color: #f0f0f0;
            font-weight: bold;
        }
        #report1 input {
            width: 100%;
            height: 100%;
            min-height: 0;
            border: none;
            text-align: center;
            outline: none;
            background: transparent;
            font-family: "Microsoft JhengHei", sans-serif;
            font-size: clamp(12px, 1.5vh, 14px);
        }

        /* ========== å ±è¡¨2ï¼ˆæ¿ä»¶ï¼‰åŸå§‹æ¨£å¼ ========= */
        #report2 {
            height: 100%;
            width: 100%;
            background-color: #333;
            display: flex; /* å¿…é ˆä¿æŒ flex æ‰èƒ½ç½®ä¸­èˆ‡å£“ç¸®é«˜åº¦ */
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        #report2 .table-wrapper {
            height: 100%;
            width: 100%;
            overflow-x: auto;
            overflow-y: hidden;
            -webkit-overflow-scrolling: touch;
            display: flex;
            justify-content: center;
        }
        #report2 .container {
            height: 100%;
            width: auto;
            aspect-ratio: 210 / 297;
            max-width: 100vw;
            background-color: #fff;
            padding: 0;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            container-type: inline-size;
        }
        @media (orientation: landscape) {
            #report2 .table-wrapper {
                overflow-y: auto;
                display: block;
            }
            #report2 .container {
                height: auto;
                min-height: 100%;
                width: max(100vw, 800px);
                margin: 0 auto;
            }
            #report2 table {
                height: auto !important;
            }
            #report2 th, #report2 td {
                height: 2.8cqw !important;
            }
        }
        #report2 .header {
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            padding: 1.5cqw 1cqw 0.5cqw 1cqw;
        }
        #report2 .logo-box {
            background-color: #000;
            color: #fff;
            padding: 0.25cqw 1.25cqw;
            font-size: 1.375cqw;
            font-style: italic;
            font-weight: bold;
            display: flex;
            flex-direction: column;
            align-items: center;
            line-height: 1.2;
            border-radius: 2px;
            margin-right: 1.875cqw;
        }
        #report2 .logo-box span:first-child {
            font-size: 1.625cqw;
        }
        #report2 .title {
            font-size: 2.75cqw;
            font-weight: bold;
            letter-spacing: 0.3cqw;
            flex-grow: 1;
            text-align: center;
            padding-right: 2.5cqw;
        }
        #report2 .year-text {
            font-size: 2.2cqw;
            font-weight: bold;
            white-space: nowrap;
        }
        #report2 table {
            width: 100%;
            border-collapse: collapse;
            border: 0.3cqw solid black;
            flex: 1 1 0%;
            min-height: 0;
            height: 1px;
            table-layout: fixed;
        }
        #report2 th, #report2 td {
            border: 0.125cqw solid black;
            text-align: center;
            padding: 0;
            height: 1%;
            white-space: nowrap;
            overflow: hidden;
            color: #000;
            font-size: 1.7cqw;
        }
        #report2 th {
            background-color: #fff;
            font-weight: normal;
            padding: 0.4cqw 0;
        }
        #report2 .col-date { width: 8%; }
        #report2 .col-no { width: 16%; }
        #report2 .col-station { width: 8%; }
        #report2 .col-orig { width: 8%; }
        #report2 .col-reason { width: 20%; }
        #report2 .col-blank1 { width: 7%; }
        #report2 .col-blank2 { width: 7%; }
        #report2 .col-reg { width: 10%; }
        #report2 .col-sign { width: 16%; }
        #report2 .footer {
            display: flex;
            justify-content: space-between;
            padding: 1.5cqw 1cqw 1cqw 1cqw;
            font-size: 2cqw;
            font-weight: bold;
        }
        #report2 .underline-box {
            border-bottom: 0.15cqw solid black;
            min-width: 15cqw;
            display: inline-block;
            text-align: center;
            padding: 0 1cqw;
        }
        #report2 input {
            width: 100%;
            height: 100%;
            min-height: 0;
            border: none;
            outline: none;
            text-align: center;
            background: transparent;
            font-family: "Microsoft JhengHei", sans-serif;
            font-size: 1.7cqw;
        }
    </style>
</head>
<body>
    <div class="selection-screen" id="selectionScreen">
        <div class="selection-card">
            <h2>ğŸ“‹ å¿«éå ±è¡¨</h2>
            <div class="month-picker">
                <label>ğŸ“… é¸æ“‡å¹´æœˆ</label>
                <input type="month" id="monthPicker">
            </div>
            <div class="report-type">
                <button id="typeMonthBtn" class="type-btn active">ğŸ“‹ æœˆä»¶</button>
                <button id="typeBoardBtn" class="type-btn">ğŸ“¦ æ¿ä»¶</button>
            </div>
        </div>
    </div>

    <div id="reportContainer" class="report-container">
        <button class="fixed-exit" id="exitReportBtn">â† é€€å‡º</button>

        <div id="report1" style="display: none;">
            <div class="table-wrapper">
                <div class="page">
                    <div class="header">
                        <div style="display: flex; gap: 20px;">
                            <div>å·¥ç·¨è™Ÿï¼š<span class="underline"></span></div>
                            <div>å“¡å·¥å§“åï¼š<span class="underline">é˜¿è£•</span></div>
                        </div>
                        <div style="font-size: 18px; font-weight: bold;">
                            <span id="year1">114</span> å¹´ <span id="month1">01</span> æœˆä»¶å ±å‘Š
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th class="col-date">æ—¥æœŸ</th><th>é€ä»¶</th><th>æ”¶ä»¶</th><th>æ¿æ•¸</th><th>ä»£å–ä»¶</th><th>ä»£æ”¶ç¸½é‡‘é¡</th><th>ç¸½å–®æ•¸</th><th>æ”¶æ¬¾</th>
                                <th class="col-date">æ—¥æœŸ</th><th>é€ä»¶</th><th>æ”¶ä»¶</th><th>æ¿æ•¸</th><th>ä»£å–ä»¶</th><th>ä»£æ”¶ç¸½é‡‘é¡</th><th>ç¸½å–®æ•¸</th><th>æ”¶æ¬¾</th>
                            </tr>
                        </thead>
                        <tbody id="tbody1"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="report2" style="display: none;">
            <div class="table-wrapper">
                <div class="container">
                    <div class="header">
                        <div class="logo-box">
                            <span>æ–°èˆªå¿«é</span>
                            <span>EXPRESS</span>
                        </div>
                        <div class="title">æ–°èˆªå¿«é(æ¿)(æ°´)è¨˜éŒ„è¡¨</div>
                        <div class="year-text">
                            <span id="year2">114</span> å¹´&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id="month2">01</span> æœˆ
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th class="col-date">æ—¥æœŸ</th>
                                <th class="col-no">è²¨å–®è™Ÿç¢¼</th>
                                <th class="col-station">ç™¼é€ç«™</th>
                                <th class="col-orig">åŸä»¶æ•¸</th>
                                <th class="col-reason">æ”¹ä»¶åŸå› </th>
                                <th class="col-blank1"></th>
                                <th class="col-blank2"></th>
                                <th class="col-reg">ç™»è¨˜ä»¶æ•¸</th>
                                <th class="col-sign">ä¸»ç®¡ç°½å</th>
                            </tr>
                        </thead>
                        <tbody id="tbody2"></tbody>
                    </table>
                    <div class="footer">
                        <div>çµ„åˆ¥ï¼š<span class="underline-box"></span></div>
                        <div>å¸æ©Ÿï¼š<span class="underline-box">é˜¿è£•</span></div> 
                        <div>ç¸½ä»¶æ•¸ï¼š<span class="underline-box"></span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        (function() {
            function fillReport1() {
                const tbody = document.getElementById('tbody1');
                if (!tbody) return;
                let html = '';
                for (let i = 1; i <= 16; i++) {
                    let r = i + 16;
                    let rT = r <= 31 ? r + 'æ—¥' : '';
                    html += `<tr>
                        <td class="col-date">${i}æ—¥</td>
                        ${'<td><input type="text"></td>'.repeat(7)}
                        <td class="col-date">${rT}</td>
                        ${'<td><input type="text"></td>'.repeat(7)}
                    </tr>`;
                }
                tbody.innerHTML = html;
            }

            function fillReport2() {
                const tbody = document.getElementById('tbody2');
                if (!tbody) return;
                let html = '';
                for (let i = 0; i < 35; i++) {
                    html += `<tr>
                        <td><input type="text"></td>
                        <td><input type="text"></td>
                        <td><input type="text"></td>
                        <td><input type="text"></td>
                        <td><input type="text"></td>
                        <td><input type="text"></td>
                        <td><input type="text"></td>
                        <td><input type="text"></td>
                        <td><input type="text"></td>
                    </tr>`;
                }
                tbody.innerHTML = html;
            }

            function updateYearMonth() {
                const picker = document.getElementById('monthPicker');
                if (!picker || !picker.value) return;
                const [yearAD, month] = picker.value.split('-');
                const rocYear = parseInt(yearAD, 10) - 1911;
                document.getElementById('year1').textContent = rocYear;
                document.getElementById('month1').textContent = month;
                document.getElementById('year2').textContent = rocYear;
                document.getElementById('month2').textContent = month;
            }

            fillReport1();
            fillReport2();
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const picker = document.getElementById('monthPicker');
            if (picker) {
                picker.value = `${year}-${month}`;
                updateYearMonth();
            }

            const btnMonth = document.getElementById('typeMonthBtn');
            const btnBoard = document.getElementById('typeBoardBtn');
            const reportContainer = document.getElementById('reportContainer');
            const selectionScreen = document.getElementById('selectionScreen');
            const report1 = document.getElementById('report1');
            const report2 = document.getElementById('report2');

            function showReport(type) {
                updateYearMonth();
                if (type === 'month') {
                    report1.style.display = 'block';
                    report2.style.display = 'none';
                    btnMonth.classList.add('active');
                    btnBoard.classList.remove('active');
                } else {
                    report1.style.display = 'none';
                    /* ã€é—œéµä¿®æ­£ã€‘æŠŠåŸæœ¬çš„ block æ”¹æˆ flexï¼Œè®“æ¿ä»¶è¡¨æ’ç‰ˆæ¢å¾©æ­£å¸¸ */
                    report2.style.display = 'flex'; 
                    btnBoard.classList.add('active');
                    btnMonth.classList.remove('active');
                }
                selectionScreen.style.display = 'none';
                reportContainer.classList.add('show');
            }

            btnMonth.addEventListener('click', () => showReport('month'));
            btnBoard.addEventListener('click', () => showReport('board'));

            document.getElementById('exitReportBtn').addEventListener('click', function() {
                reportContainer.classList.remove('show');
                selectionScreen.style.display = 'flex';
            });

            picker.addEventListener('change', updateYearMonth);
        })();
    </script>
</body>
</html>
